# 关于kamis动态切换主题以及业务方怎么维护自己业务主题的解决方案

## 需求背景
标准范式图表用例对应的配置项组成和结构如下：
- 第一层：特殊组件内置的逻辑设置。(如瀑布图series.dvType: 'waterfall'、韦恩图series.dvType: 'venn'、标记图series.dvType: 'dvMarker'、进度条图series.dvType: 'progress'等)
- 第二层：组件开发时约定俗成的配置项设定/设计规范定义的组件形态。(y轴分段数splitLineNumber: 5、折线数据点高低密度阈值dvShowSymbolStrategy: 13等)
- 第三层：不同产品业务线的图表样式规范以及**相关Token**。(mobile手炒主题x轴的三段式、ainvest的y轴位置默认靠右、pc的series水平方向存在左右24的安全边距等)
- 第四层：实际落地的具体图表应用案例的微调。(ETF-F10的插值柱状图将分组柱状图编排到2个y轴并设计不同的配色方案、Aime基准-目标收益差异折线图的区域配色魔改方案等)
- 第五层：图表应用案例封装成kamis组件后，设计师/产品经理在此基础上对样式的微调。(主要为图表视觉样式调整，不在列举)

为降低业务方开发对图表配置和通用设计规范（**第一、二、三层**）的理解成本，我们封装了基于业务线的**配置项主题**，让业务开发专注于对落地图表的微调上。
然而，这也导致落地的图表和某个特定的业务线主题绑定在一起，在接入可视化组件kamis平台的过程中，出现如下几个问题场景：
- 不同业务线的产品有互相参考可视化表现的需求，但具体用例与业务线主题强绑定，为某个案例专门维护一套主题的方案成本过高。
- 以图表案例为基础构建的kamis组件因为强绑定，使用范围多局限于构建的业务线。
- 范式组件的上层应用AIGC组件库在接入kamis后，无法快速融合对应业务线的风格/样式，导致可视化组件AI推荐的方案难以进行。

## 主要功能拆解

为解决以上几个问题，我们决定重组当前的图表主题结构，调整主题定义的方式：
1. 重组当前的图表主题结构
- 引入token机制，统一管理图表大部分视觉/动画属性。
- 剥离组件库中为实现设计规范的配置项处理方法，以构成图表的原子组件为单位分割为基本配置项预处理函数。
2. 调整主题定义的方式
- 开放业务方自定义主题的能力。
- 支持根据远程主题`镜像`微调的能力
- 支持将本地主题导出生成`镜像`的能力

## 


